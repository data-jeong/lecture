-- Chapter 12: 데이터 분석가 인터뷰 기초 분석 문제

-- 문제 1: 월별 매출 증감률 계산
-- 월별 총 매출을 구하고, 전월 대비 증감률을 계산하세요.
-- 결과: 년월, 월별 매출, 전월 매출, 증감률(%)
-- 힌트: orders 테이블 사용, LAG 윈도우 함수 활용


-- 문제 2: 상위 10% 고객 식별 (파레토 법칙)
-- 전체 매출의 80%를 차지하는 상위 고객들을 식별하세요.
-- 결과: 고객 ID, 총 구매액, 누적 매출 비율, VIP 여부
-- 힌트: 누적 합계와 백분율 계산


-- 문제 3: 제품별 재구매율 계산
-- 각 제품을 구매한 고객 중 재구매한 고객의 비율을 계산하세요.
-- 결과: 제품명, 총 구매 고객수, 재구매 고객수, 재구매율(%)
-- 힌트: EXISTS 또는 윈도우 함수 활용


-- 문제 4: 계절성 트렌드 분석
-- 월별 매출에서 계절성 패턴을 분석하세요. (전년 동월 대비)
-- 결과: 월, 2023년 매출, 2022년 매출, YoY 성장률, 계절성 지수
-- 힌트: 12개월 LAG 사용, 계절성 지수 = 해당월 매출 / 연평균 매출


-- 문제 5: 고객 획득 비용(CAC) 계산
-- 마케팅 캠페인별 고객 획득 비용을 계산하세요.
-- 결과: 캠페인명, 총 비용, 신규 고객수, CAC, ROI
-- 힌트: 캠페인 데이터와 신규 고객 가입 데이터 연결


-- 문제 6: 구독 서비스 이탈률 분석
-- 월별 구독 이탈률(Churn Rate)과 순 증가율을 계산하세요.
-- 결과: 년월, 시작 구독자수, 신규 가입, 이탈, 이탈률(%), 순 증가율(%)
-- 힌트: 구독 시작일과 종료일을 기준으로 월별 집계


-- 문제 7: 웹사이트 퍼널 분석
-- 홈페이지 → 상품페이지 → 장바구니 → 구매 퍼널의 전환율을 계산하세요.
-- 결과: 단계명, 사용자수, 이전 단계 대비 전환율, 전체 대비 전환율
-- 힌트: page_views 테이블을 활용한 단계별 사용자 추적


-- 문제 8: 고객 세그멘테이션 (RFM 간소화 버전)
-- 최근 구매일(R)과 총 구매액(M)을 기준으로 고객을 4개 그룹으로 분류하세요.
-- 결과: 고객 ID, 최근 구매일, 총 구매액, R점수, M점수, 고객 등급
-- 힌트: NTILE 함수로 각각 2분위로 나누어 2x2 매트릭스 생성


-- 문제 9: A/B 테스트 결과 분석
-- 'Checkout Flow Optimization' 테스트의 전환율을 비교 분석하세요.
-- 결과: 그룹명, 참가자수, 전환수, 전환율(%), 통계적 유의성 판단
-- 힌트: 각 그룹별 전환율 계산 후 비교


-- 문제 10: 일일 활성 사용자(DAU) 트렌드 분석
-- 최근 30일간의 일일 활성 사용자 수와 7일 이동평균을 계산하세요.
-- 결과: 날짜, DAU, 7일 이동평균, 전일 대비 변화율
-- 힌트: page_views에서 일별 순 사용자 집계


-- 문제 11: 상품 카테고리별 성과 분석
-- 각 카테고리의 매출, 주문수, 평균 주문액을 분석하세요.
-- 결과: 카테고리, 총 매출, 주문수, 평균 주문액, 전체 매출 점유율
-- 힌트: products와 order_items 테이블 조인


-- 문제 12: 고객 코호트 분석 (단순화 버전)
-- 2023년 각 월별 신규 고객의 다음달 재구매율을 계산하세요.
-- 결과: 신규 가입월, 신규 고객수, 다음달 재구매 고객수, 재구매율(%)
-- 힌트: 첫 구매월을 기준으로 코호트 구성


-- 문제 13: 마케팅 채널별 효과 분석
-- 각 마케팅 채널의 비용 대비 효과를 분석하세요.
-- 결과: 채널명, 총 비용, 전환수, CPA(Cost Per Acquisition), ROAS
-- 힌트: 캠페인 데이터와 전환 데이터 연결


-- 문제 14: 사용자 세션 분석
-- 평균 세션 시간, 페이지뷰/세션, 이탈률을 계산하세요.
-- 결과: 날짜, 총 세션수, 평균 세션 시간, 평균 페이지뷰, 이탈률(%)
-- 힌트: session_id를 기준으로 세션별 집계


-- 문제 15: 매출 기여도 분석
-- 각 제품이 전체 매출에서 차지하는 비중과 누적 기여도를 계산하세요.
-- 결과: 제품명, 매출액, 매출 비중(%), 누적 비중(%), ABC 분류
-- 힌트: 매출 기준 정렬 후 누적 비중 계산, 상위 80%까지는 A등급