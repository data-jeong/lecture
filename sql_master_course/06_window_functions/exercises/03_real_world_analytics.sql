-- Chapter 06: 실무 분석 윈도우 함수 실습 문제
-- 실제 비즈니스 시나리오를 기반으로 한 고급 분석 쿼리

-- 문제 1: 완전한 코호트 분석을 구현하세요.
-- 월별 신규 고객 코호트의 리텐션율을 계산하고 히트맵 형태의 데이터를 생성하세요.
-- 결과: 코호트 월, 기간(0개월, 1개월, 2개월...), 고객수, 리텐션율(%)
-- 힌트: 첫 주문월을 기준으로 코호트 구성, 각 기간별 재구매 고객 비율 계산


-- 문제 2: 고급 RFM 고객 세그멘테이션을 구현하세요.
-- Recency, Frequency, Monetary를 기반으로 11개 고객 세그먼트를 생성하세요.
-- (Champions, Loyal Customers, Potential Loyalists, New Customers, Promising, 
--  Need Attention, About to Sleep, At Risk, Cannot Lose Them, Hibernating, Lost)
-- 결과: 고객명, R/F/M 점수, 세그먼트, 예상 CLV, 추천 액션
-- 힌트: RFM 점수 조합에 따른 세그먼트 분류 로직 구현


-- 문제 3: 상품별 재고 회전율 심화 분석을 수행하세요.
-- 계절성을 고려한 재고 회전율, 최적 재고 수준, 재고 부족/과잉 알림을 구현하세요.
-- 결과: 상품명, 현재 재고, 월평균 회전율, 계절 조정 회전율, 최적 재고, 상태, 액션
-- 힌트: 계절성 인덱스 계산, 안전 재고 고려한 최적 재고 수준 산정


-- 문제 4: 직원 성과 트렌드 종합 분석을 수행하세요.
-- 개인별 성과 트렌드, 부서 평균 대비 상대 성과, 성과 개선/악화 패턴을 분석하세요.
-- 결과: 직원명, 부서, 성과 트렌드, 상대적 포지션, 개선률, 예측 성과, 개발 필요도
-- 힌트: 선형 회귀를 SQL로 구현하여 트렌드 분석


-- 문제 5: 매출 예측 모델을 구현하세요.
-- 과거 매출 패턴을 분석하여 향후 3개월 매출을 예측하세요.
-- 트렌드, 계절성, 노이즈를 분리하여 예측 정확도를 높이세요.
-- 결과: 예측 월, 트렌드 성분, 계절 성분, 예측값, 신뢰구간(상한/하한)
-- 힌트: 이동 평균, 계절성 분해, 예측 구간 계산


-- 문제 6: 고객 이탈 위험도 스코어링을 구현하세요.
-- 다양한 지표를 종합하여 고객별 이탈 위험도를 0-100점으로 산출하세요.
-- 최근 활동, 구매 빈도 변화, 구매 금액 변화, 고객 서비스 이슈 등을 종합 고려하세요.
-- 결과: 고객명, 각 위험 요소별 점수, 종합 위험도, 위험 등급, 대응 우선순위
-- 힌트: 다차원 지표를 가중 평균으로 통합, 상대적 위험도 계산


-- 문제 7: 가격 탄력성 분석을 수행하세요.
-- 상품별 가격 변동에 따른 수요 변화를 분석하여 최적 가격을 제안하세요.
-- 결과: 상품명, 현재 가격, 가격 탄력성, 예상 최적 가격, 예상 매출 증가율
-- 힌트: 가격과 판매량의 상관관계 분석, 탄력성 계산


-- 문제 8: 크로스셀/업셀 기회 분석을 구현하세요.
-- 상품간 연관성을 분석하여 고객별 추천 상품과 성공 확률을 계산하세요.
-- 결과: 고객명, 기구매 상품, 추천 상품, 연관도, 구매 확률, 예상 매출 기여도
-- 힌트: 장바구니 분석을 SQL로 구현, 신뢰도/지지도 계산


-- 문제 9: 공급망 최적화 분석을 수행하세요.
-- 상품별 리드타임, 수요 변동성, 공급업체 신뢰도를 고려한 최적 발주 정책을 제안하세요.
-- 결과: 상품명, 평균 리드타임, 수요 변동성, 안전 재고, 최적 발주점, 발주량
-- 힌트: 재고 모델링, 불확실성 하에서의 최적화


-- 문제 10: 마케팅 캠페인 효과 측정을 구현하세요.
-- (가상의 캠페인 데이터를 가정하고) 캠페인별 ROI, 고객 획득 비용, 증분 효과를 측정하세요.
-- 결과: 캠페인명, 투자액, 신규 고객수, 증분 매출, ROI, CAC, 장기 가치 기여도
-- 힌트: Before/After 분석, 증분 효과 계산, 어트리뷰션 모델링


-- 문제 11: 경쟁사 대비 포지셔닝 분석을 수행하세요.
-- (가상의 경쟁사 데이터를 생성하여) 가격, 품질, 고객 만족도 측면에서 포지셔닝을 분석하세요.
-- 결과: 상품 카테고리, 우리 포지션, 경쟁사 평균, 포지셔닝 갭, 개선 기회, 전략 제안
-- 히트: 다차원 비교 분석, 경쟁 우위 요소 식별


-- 문제 12: 고객 생애 가치(CLV) 예측 모델을 구현하세요.
-- 과거 구매 패턴을 바탕으로 고객별 향후 12개월 CLV를 예측하세요.
-- 결과: 고객명, 현재까지 총 구매액, 평균 주문 주기, 평균 주문액, 예측 CLV, 신뢰도
-- 힌트: 구매 확률 모델, 생존 분석 개념 적용


-- 문제 13: 동적 가격 최적화 시뮬레이션을 구현하세요.
-- 수요 탄력성, 경쟁사 가격, 재고 수준을 고려한 동적 가격 최적화를 시뮬레이션하세요.
-- 결과: 상품명, 현재 가격, 시나리오별 최적 가격, 예상 매출, 예상 이익, 최적 전략
-- 힌트: 다양한 시나리오 분석, 수익 최적화 계산


-- 문제 14: 옴니채널 고객 여정 분석을 구현하세요.
-- (온라인/오프라인 가정 데이터로) 채널별 고객 여정과 채널간 기여도를 분석하세요.
-- 결과: 고객명, 터치포인트 순서, 채널별 기여도, 최종 구매 채널, 여정 패턴 유형
-- 힌트: 어트리뷰션 모델링, 채널별 기여도 분배


-- 문제 15: 종합 비즈니스 대시보드를 구현하세요.
-- KPI 트렌드, 성과 요인 분석, 예측, 알림을 포함한 임원진용 대시보드 쿼리를 작성하세요.
-- 결과: KPI명, 현재값, 목표값, 달성률, 전년 대비, 트렌드, 예측값, 위험 신호
-- 힌트: 모든 분석 기법을 종합한 마스터 쿼리