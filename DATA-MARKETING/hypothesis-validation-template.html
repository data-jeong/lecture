<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가설 검증 워크시트 템플릿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #1a73e8;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .description {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .download-section {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background-color: #1a73e8;
            color: white;
        }

        .btn-primary:hover {
            background-color: #1557b0;
        }

        .btn-secondary {
            background-color: #34a853;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #2d8e47;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 15px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 15px;
            text-align: left;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
            width: 25%;
        }

        td {
            background-color: white;
            min-height: 60px;
            vertical-align: top;
        }

        .editable {
            background-color: white;
            min-height: 60px;
            line-height: 1.6;
        }

        .example-text {
            color: #666;
            font-style: italic;
            font-size: 14px;
        }

        .hypothesis-section {
            margin-bottom: 40px;
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            table {
                font-size: 13px;
            }
            
            th, td {
                padding: 10px;
            }

            th {
                width: 35%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>가설 검증 워크시트 템플릿</h1>
        <p class="subtitle">데이터 기반 의사결정을 위한 구조화된 실험 프레임워크</p>

        <div class="description">
            <p>이 템플릿은 비즈니스 가설을 체계적으로 검증하고 데이터 기반 의사결정을 내리는 데 도움을 줍니다.
            각 항목을 꼼꼼히 작성하여 실험의 목적, 방법, 결과를 명확히 문서화하세요.
            이는 팀 내 지식 공유와 향후 참고 자료로 활용됩니다.</p>
        </div>

        <div class="download-section">
            <button class="btn btn-primary" onclick="exportToExcel()">Excel로 다운로드</button>
            <button class="btn btn-secondary" onclick="exportToCSV()">CSV로 다운로드</button>
        </div>

        <div class="hypothesis-section">
            <h2>가설 검증 워크시트</h2>
            <table id="hypothesisTable">
                <tbody>
                    <tr>
                        <th>문제 정의</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">해결하고자 하는 비즈니스 문제는 무엇인가?<br>
                            예: 모바일 사용자의 구매 전환율이 데스크톱 사용자보다 30% 낮다.</span>
                        </td>
                    </tr>
                    <tr>
                        <th>가설</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">"우리는...라고 믿는다" 형식의 완전한 문장<br>
                            예: 우리는 모바일 결제 프로세스를 3단계에서 1단계로 줄이면, 모바일 구매 전환율이 15% 증가할 것이라고 믿는다.</span>
                        </td>
                    </tr>
                    <tr>
                        <th>타겟 잠재고객/세그먼트</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">이 테스트는 누구를 대상으로 하는가?<br>
                            예: 모든 모바일 기기 사용자 (iOS/Android 앱 및 모바일 웹)</span>
                        </td>
                    </tr>
                    <tr>
                        <th>성공 지표<br>(주요 & 가드레일)</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">변화를 기대하는 주요 KPI는 무엇인가? 악화되어서는 안 되는 KPI는 무엇인가?<br>
                            예: 주요 지표: 세션 전환율 (목표: +15%)<br>
                            가드레일 지표: 평균 주문 가치 (최소 유지), 반품률 (5% 이하 유지)</span>
                        </td>
                    </tr>
                    <tr>
                        <th>실행 세부사항</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">정확히 무엇을 변경/구축해야 하는가?<br>
                            예: 1) 원클릭 결제 버튼 도입<br>
                            2) 결제 정보 자동 완성 기능 구현<br>
                            3) GTM을 통해 결제 단계별 이탈률 추적 설정</span>
                        </td>
                    </tr>
                    <tr>
                        <th>테스트 기간 및 샘플 크기</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">실험 기간과 필요한 최소 샘플 크기<br>
                            예: 테스트 기간: 2주 (2024.01.15 - 2024.01.29)<br>
                            필요 샘플: 각 그룹당 최소 10,000 세션</span>
                        </td>
                    </tr>
                    <tr>
                        <th>결과</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">테스트에서 얻은 정량적 데이터<br>
                            예: 실험군 전환율: 3.5% (n=12,345)<br>
                            대조군 전환율: 3.1% (n=12,567)<br>
                            상승률: +12.9%, 통계적 유의성: 95% (p-value: 0.023)</span>
                        </td>
                    </tr>
                    <tr>
                        <th>결론 및 다음 단계</th>
                        <td contenteditable="true" class="editable">
                            <span class="example-text">가설이 검증되었는가? 무엇을 배웠는가? 전면 도입할 것인가, 반복할 것인가, 포기할 것인가?<br>
                            예: 가설 부분 검증됨. 전환율은 유의미하게 증가했으나 목표치(15%)에는 미달.<br>
                            다음 단계: 1) 전체 트래픽의 50%로 확대 적용<br>
                            2) UX 개선사항 추가 반영 후 재테스트</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="hypothesis-section">
            <h2>추가 가설 검증 워크시트</h2>
            <p style="margin-bottom: 20px; color: #666;">여러 가설을 동시에 관리할 때 사용하세요.</p>
            <table id="additionalHypothesisTable">
                <tbody>
                    <tr>
                        <th>문제 정의</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>가설</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>타겟 잠재고객/세그먼트</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>성공 지표<br>(주요 & 가드레일)</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>실행 세부사항</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>테스트 기간 및 샘플 크기</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>결과</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                    <tr>
                        <th>결론 및 다음 단계</th>
                        <td contenteditable="true" class="editable"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // 예시 텍스트 처리
        document.querySelectorAll('.editable').forEach(cell => {
            cell.addEventListener('focus', function() {
                const exampleText = this.querySelector('.example-text');
                if (exampleText) {
                    exampleText.style.display = 'none';
                }
            });
            
            cell.addEventListener('blur', function() {
                const exampleText = this.querySelector('.example-text');
                if (exampleText && this.textContent.trim() === '') {
                    exampleText.style.display = 'block';
                }
            });
        });

        // Excel 다운로드 함수
        function exportToExcel() {
            let excelContent = '<html><head><meta charset="utf-8"/><style>table{border-collapse:collapse;}th,td{border:1px solid black;padding:10px;}th{background-color:#f0f0f0;}</style></head><body>';
            
            excelContent += '<h2>가설 검증 워크시트</h2>';
            
            // 첫 번째 테이블 처리
            const table1 = document.getElementById('hypothesisTable').cloneNode(true);
            // 예시 텍스트 제거
            table1.querySelectorAll('.example-text').forEach(el => el.remove());
            excelContent += '<table>' + table1.innerHTML + '</table>';
            
            excelContent += '<br/><br/>';
            
            // 두 번째 테이블이 내용이 있는 경우에만 추가
            const table2 = document.getElementById('additionalHypothesisTable');
            const hasContent = Array.from(table2.querySelectorAll('.editable')).some(cell => 
                cell.textContent.trim() !== '' && !cell.querySelector('.example-text')
            );
            
            if (hasContent) {
                excelContent += '<h2>추가 가설 검증 워크시트</h2>';
                const table2Clone = table2.cloneNode(true);
                table2Clone.querySelectorAll('.example-text').forEach(el => el.remove());
                excelContent += '<table>' + table2Clone.innerHTML + '</table>';
            }
            
            excelContent += '</body></html>';
            
            const blob = new Blob([excelContent], {
                type: 'application/vnd.ms-excel;charset=utf-8;'
            });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '가설_검증_워크시트.xls';
            link.click();
        }

        // CSV 다운로드 함수
        function exportToCSV() {
            let csvContent = '가설 검증 워크시트\n\n';
            
            // 첫 번째 테이블
            const table1 = document.getElementById('hypothesisTable');
            const rows1 = table1.querySelectorAll('tr');
            
            rows1.forEach(row => {
                const cells = row.querySelectorAll('th, td');
                const rowData = [];
                
                cells.forEach(cell => {
                    // 예시 텍스트 제외하고 실제 내용만 추출
                    const cellClone = cell.cloneNode(true);
                    const exampleText = cellClone.querySelector('.example-text');
                    if (exampleText) exampleText.remove();
                    
                    let text = cellClone.innerText || cellClone.textContent;
                    text = text.replace(/"/g, '""');
                    if (text.includes(',') || text.includes('\n')) {
                        text = `"${text}"`;
                    }
                    rowData.push(text);
                });
                
                csvContent += rowData.join(',') + '\n';
            });
            
            // 두 번째 테이블 체크
            const table2 = document.getElementById('additionalHypothesisTable');
            const hasContent = Array.from(table2.querySelectorAll('.editable')).some(cell => 
                cell.textContent.trim() !== '' && !cell.querySelector('.example-text')
            );
            
            if (hasContent) {
                csvContent += '\n\n추가 가설 검증 워크시트\n\n';
                const rows2 = table2.querySelectorAll('tr');
                
                rows2.forEach(row => {
                    const cells = row.querySelectorAll('th, td');
                    const rowData = [];
                    
                    cells.forEach(cell => {
                        const cellClone = cell.cloneNode(true);
                        const exampleText = cellClone.querySelector('.example-text');
                        if (exampleText) exampleText.remove();
                        
                        let text = cellClone.innerText || cellClone.textContent;
                        text = text.replace(/"/g, '""');
                        if (text.includes(',') || text.includes('\n')) {
                            text = `"${text}"`;
                        }
                        rowData.push(text);
                    });
                    
                    csvContent += rowData.join(',') + '\n';
                });
            }
            
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], {
                type: 'text/csv;charset=utf-8;'
            });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '가설_검증_워크시트.csv';
            link.click();
        }
    </script>
</body>
</html>